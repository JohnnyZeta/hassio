
########## PULSANTE SALONE #####################################################

# 1 CLICK
  - alias: Pulsante_Netflix_ON
    trigger:
      platform: event
      event_type: click
      event_data:
        entity_id: binary_sensor.switch_158d000120d46e
        click_type: single
    condition:
      condition: template
      value_template: '{{ states.light.tv.attributes.brightness > 250 }}'
    action:
      - service: hue.hue_activate_scene
        data:
          group_name: "Casa"
          scene_name: "Netflixo"

  - alias: Pulsante_Netflix_OFF
    trigger:
      platform: event
      event_type: click
      event_data:
        entity_id: binary_sensor.switch_158d000120d46e
        click_type: single
    condition:
      condition: template
      value_template: '{{ states.light.tv.attributes.brightness < 100 }}'
    action:
      - service: hue.hue_activate_scene
        data:
          group_name: "Casa"
          scene_name: "TVOff"

# 2 CLICK
  - alias: Pulsante_Prova
    trigger:
      platform: event
      event_type: click
      event_data:
        entity_id: binary_sensor.switch_158d000120d46e
        click_type: double
    action:
      - service: xiaomi_aqara.play_ringtone
        data:
          gw_mac: 78:11:DC:B0:72:7E
          ringtone_id: 12
          ringtone_vol: 30

########## PULSANTE ALBY ######################################################

# 1 CLICK
  - alias: Pulsante_Nanna_Alby
    trigger:
      platform: event
      event_type: click
      event_data:
        entity_id: binary_sensor.switch_158d00016c48b3
        click_type: single
    condition:
      condition: or
      conditions:
        - condition: state
          entity_id: light.tv
          state: 'on'
        - condition: state
          entity_id: light.camera
          state: 'off'
        - condition: template
          value_template: '{{ states.light.camera_2.attributes.color_temp > 200 }}'
    action:
      service: hue.hue_activate_scene
      data:
        group_name: "Casa"
        scene_name: "Nanna"

  - alias: Annulla_Pulsante_Nanna_Alby
    trigger:
      platform: event
      event_type: click
      event_data:
        entity_id: binary_sensor.switch_158d00016c48b3
        click_type: single
    condition:
      condition: template
      value_template: '{{ states.light.camera_2.attributes.color_temp < 200 }}'
    action:
      service: hue.hue_activate_scene
      data:
        group_name: "Camera"
        scene_name: "Tenue"

# 2 CLICK
  - alias: Pulsante_Scena_Nanna_Alby
    trigger:
      platform: event
      event_type: click
      event_data:
        entity_id: binary_sensor.switch_158d00016c48b3
        click_type: double
    action:
      - service: hue.hue_activate_scene
        data:
          group_name: "Casa"
          scene_name: "Nanna"
      - service: shell_command.spegni_nanna
      - delay: 00:03:00
      - service: switch.turn_off
        entity_id: switch.nuvola

# HOLD CLICK
  - alias: Pulsante_SOS_Alby
    trigger:
      platform: event
      event_type: click
      event_data:
        entity_id: binary_sensor.switch_158d00016c48b3
        click_type: hold
    action:
      - service: hue.hue_activate_scene
        data:
          group_name: "Casa"
          scene_name: "SOS"
      - service: notify.telefoni
        data_template:
          title: "SOS!"
          message: "SOS dal comodino di Alberto!"

########## PULSANTE ALE #######################################################

# 1 CLICK
  - alias: Pulsante_Nanna_Ale
    trigger:
      platform: event
      event_type: click
      event_data:
        entity_id: binary_sensor.switch_158d000120ea9c
        click_type: single
    condition:
      condition: or
      conditions:
        - condition: state
          entity_id: light.tv
          state: 'on'
        - condition: state
          entity_id: light.camera
          state: 'off'
        - condition: template
          value_template: '{{ states.light.camera_2.attributes.color_temp > 200 }}'
    action:
      service: hue.hue_activate_scene
      data:
        group_name: "Casa"
        scene_name: "Nanna"

  - alias: Annulla_Pulsante_Nanna_Ale
    trigger:
      platform: event
      event_type: click
      event_data:
        entity_id: binary_sensor.switch_158d000120ea9c
        click_type: single
    condition:
      condition: template
      value_template: '{{ states.light.camera_2.attributes.color_temp < 200 }}'
    action:
      service: hue.hue_activate_scene
      data:
        group_name: "Camera"
        scene_name: "Tenue"

# 2 CLICK
  - alias: Pulsante_Scena_Nanna_Ale
    trigger:
      platform: event
      event_type: click
      event_data:
        entity_id: binary_sensor.switch_158d000120ea9c
        click_type: double
    action:
      - service: hue.hue_activate_scene
        data:
          group_name: "Casa"
          scene_name: "Nanna"
      - service: shell_command.spegni_nanna
      - delay: 00:03:00
      - service: switch.turn_off
        entity_id: switch.nuvola

# HOLD CLICK
  - alias: Pulsante_SOS_Ale
    trigger:
      platform: event
      event_type: click
      event_data:
        entity_id: binary_sensor.switch_158d000120ea9c
        click_type: hold
    action:
      - service: hue.hue_activate_scene
        data:
          group_name: "Casa"
          scene_name: "SOS"
      - service: notify.telefoni
        data_template:
          title: "SOS!"
          message: "SOS dal comodino di Alessandra!"
      - service: notify.telegram
        data_template:
          message: "SOS dal comodino di Alessandra!"

########## PULSANTE CUCINA #####################################################

# 1 CLICK
  - alias: Pulsante_Play_Pausa
    trigger:
      platform: event
      event_type: click
      event_data:
        entity_id: binary_sensor.switch_158d000120d3ef
        click_type: single
    condition:
      - condition: template
        value_template: '{{ not is_state("media_player.yamaha_receiver", "off") }}'
    action:
      service: media_player.media_play_pause
      data:
        entity_id: media_player.yamaha_receiver

# 2 CLICK
  - alias: Pulsante_Spotify_ON_Ale
    trigger:
      platform: event
      event_type: click
      event_data:
        entity_id: binary_sensor.switch_158d000120d3ef
        click_type: double
    condition:
      - condition: state
        entity_id: device_tracker.iphone_di_alessandra
        state: 'home'
      - condition: template
        value_template: '{{ is_state("media_player.yamaha_receiver", "off") or (not is_state_attr("media_player.yamaha_receiver", "source", "Spotify")) }}'
    action:
      # Accendi lo Yamaha
      - service: media_player.turn_on
        data:
          entity_id: media_player.yamaha_receiver
      # Aspetta che sia disponibile
      - delay: '00:00:05'
      # Setta il volume di Yamaha
      - service: media_player.volume_set
        data:
          entity_id: media_player.yamaha_receiver
          volume_level: '0.50'
      # Setta il volume di Spotify
      - service: media_player.volume_set
        data:
          entity_id: media_player.spotify
          volume_level: '0.4'
      # Seleziona la sorgente
      - service: media_player.select_source
        data:
          entity_id: media_player.spotify
          source: RX-V475 A484BB
      # Attiva lo Shuffle
      - service: switch.turn_on
        data:
          entity_id: switch.shuffle_spotify
      # Riproduce la playlist Balbertandra
      - service: media_player.play_media
        data:
          entity_id: media_player.spotify
          media_content_type: playlist
          media_content_id: spotify:user:johnnyzeta:playlist:4nP3qwV8iB9nuEt0YTGk4R

  - alias: Pulsante_Spotify_ON_Alby
    trigger:
      platform: event
      event_type: click
      event_data:
        entity_id: binary_sensor.switch_158d000120d3ef
        click_type: double
    condition:
      - condition: template
        value_template: '{{ not is_state("device_tracker.iphone_di_alessandra", "home") }}'
      - condition: template
        value_template: '{{ is_state("media_player.yamaha_receiver", "off") or (not is_state_attr("media_player.yamaha_receiver", "source", "Spotify")) }}'
    action:
      # Accendi lo Yamaha
      - service: media_player.turn_on
        data:
          entity_id: media_player.yamaha_receiver
      # Aspetta che sia disponibile
      - delay: '00:00:05'
      # Setta il volume di Yamaha
      - service: media_player.volume_set
        data:
          entity_id: media_player.yamaha_receiver
          volume_level: '0.50'
      # Setta il volume di Spotify
      - service: media_player.volume_set
        data:
          entity_id: media_player.spotify
          volume_level: '0.4'
      # Seleziona la sorgente
      - service: media_player.select_source
        data:
          entity_id: media_player.spotify
          source: RX-V475 A484BB
      # Continua la riproduzione da dove interrotta
      - service: media_player.media_play_pause
        data:
          entity_id: media_player.spotify
      # Attiva lo Shuffle
      - service: switch.turn_on
        data:
          entity_id: switch.shuffle_spotify

  - alias: Pulsante_Spotify_OFF
    trigger:
      platform: event
      event_type: click
      event_data:
        entity_id: binary_sensor.switch_158d000120d3ef
        click_type: double
    condition:
      - condition: template
        value_template: '{{ not is_state("media_player.yamaha_receiver", "off") }}'
    action:
      - service: media_player.media_stop
        data:
          entity_id: media_player.spotify
      - service: media_player.turn_off
        data:
          entity_id: media_player.yamaha_receiver

# HOLD CLICK
  - alias: Pulsante_Spotify_Skippa
    trigger:
      platform: event
      event_type: click
      event_data:
        entity_id: binary_sensor.switch_158d000120d3ef
        click_type: hold
    condition:
      - condition: template
        value_template: '{{ not is_state("media_player.yamaha_receiver", "off") }}'
    action:
      - service: media_player.media_next_track
        data:
          entity_id: media_player.spotify

###############################################################################
